CI/CD overview (ч.1)

Безперервна інтеграція (CI) і безперервна доставка (CD) є важливими термінами, які використовуються в DevOps і охоплюють набір практик, які дозволяють сучасним командам розробників частіше та швидше вносити зміни в код.

Це досягається шляхом впровадження автоматизації, коли справа доходить до створення, розгортання та випуску програм.

CI гарантує, що зміни коду регулярно тестуються та деплояться після їх об’єднання в спільному репозиторії (система контролю версій), щоб забезпечити їхню стабільність, тоді як CD забезпечує швидку доставку цих змін, де їх потім можна задеплоїти у середовищі.

CI/CD сприяють ефективному випуску програмного забезпечення для релізу нових високоякісних продуктів або фіч на ринок швидше, ніж будь-коли раніше.

continuous integration
Спочатку ми глибше розглянемо концепцію безперервної інтеграції.

У сучасній розробці програмного забезпечення розробники зазвичай одночасно працюють над різними функціями.

Без постійної інтеграції, хоча розробники намагаються об’єднати зміни свого коду, зроблені в окремих гілках, існує висока ймовірність того, що ці зміни можуть конфліктувати зі змінами, внесеними іншими розробниками, що може призвести до так званого «пекла конфлікту злиття». Зазвичай це трапляється, коли розробники намагаються об’єднати кілька гілок функцій одночасно.

І безперервна інтеграція (CI) дозволяє розробникам об’єднувати зміни коду в спільний білд.

За допомогою цього методу розробники можуть інтегрувати свої зміни або фіксувати код невеликими кроками, набагато частіше, можливо, навіть кілька разів на день. Кожен коміт запускатиме автоматичне збирання та тестування.

Іншими словами, після об’єднання цих змін серія автоматизованих тестів перевірить білд, щоб виявити будь-які помилки, щоб усі помилки можна було швидко виправити без порушення роботи проду.

ПЕРЕВАГИ БЕЗПЕРЕРВНОЇ ІНТЕГРАЦІЇ
Оскільки розробники часто вносять невеликі зміни, це дозволяє швидше деплоїти. Це також забезпечує швидший зворотний зв’язок, щоб розробники могли майже негайно виправляти помилки.
Отже, безперервна інтеграція призводить до релізів вищої якості, оскільки помилки можна швидко виявляти та виправляти, що сприяє підвищенню ефективності та продуктивності, оскільки розробникам більше не потрібно чекати, поки всі інші завершать вносити свої власні зміни.

І противага безпервній інтеграції - це підхід, коли розробники вносять свої зміни тільки в гілку мастер і чекають на деплой лише з цієї гілки - що потребує багато часу, і збільшує час на білд і багато часу на тестування - тому що велика кількість змін.


continuous delivery
Безперервна доставка – це підхід до деплою програмного забезпечення, коли команди часто випускають якісні продукти за допомогою серії автоматизованих тестів. Для ефективного процесу безперервної доставки безперервне розгортання також має бути вбудовано у ваш пайпалайн. Про це трохи пізніше. Тому метою безперервної доставки є програмне забезпечення, яке завжди готове до деплою у середовищі з репозиторію. Іншими словами, це гарантує, що код завжди в стані розгортання, навіть якщо кілька розробників вносять щоденні зміни через постійну інтеграцію. Хоча це зазвичай автоматизований процес, фактичний випуск у виробниче середовище може бути виконано вручну командами.

ПЕРЕВАГИ БЕЗПЕРЕРВНОЇ ДОСТАВКИ (CD) ДУЖЕ ЧІТКІ І ЗРОЗУМІЛІ
Можливо, найбільш очевидною перевагою є швидший час виходу на ринок, оскільки код завжди готовий до розгортання для користувачів.
Це також означає, що завдяки безперервній доставці ви зможете досягти постійного циклу зворотного зв’язку, що дозволить командам отримувати постійні фідбеки про продукти від кінцевих користувачів, а потім включити ці фідбеки і якщо потрібно фікси у наступний реліз.
Це також підвищує продуктивність, оскільки командам більше не доводиться вирішувати виснажливі завдання (як вирішення конфліктів при великій кількості пр), які натомість виконуються в пайплайнах, що дозволяє цим командам зосередитися на створенні кращих продуктів, що призводить до підвищення задоволеності клієнтів.
Крім того, коли зміни випускаються частіше невеликими кроками, помилки можна легко та швидко помітити та виправити, тим самим зменшуючи типові ризики, пов’язані з випусками.
Continuous integration vs continuous delivery vs continuous deployment
У розробці програмного забезпечення процес починається з безперервної інтеграції, потім безперервна доставка будується на цьому процесі, щоб зарелізити зміни, які були об’єднані в спільний білд під час безперервної інтеграції. Це означає, що безперервна доставка дає змогу автоматизовано розгортати код від етапу розробки до етапу виробництва.

Отже, CI/CD представляють собою процес безперервної розробки, тестування та доставки нових випусків.

Безперервне розгортання (continuous delivery), яке часто плутають із безперервним постачанням (continuous deployment), насправді йде на крок далі, ніж безперервне постачання.

На цьому етапі всі зміни автоматично випускаються без будь-якого втручання людини, тоді як у безперервній доставці (continuous delivery) зміни готуються до доставки, але команда визначає, коли вони будуть задеплоєні вручну.

Підсумовуючи ці три основні поняття:

Безперервна інтеграція (CI) – короткочасні гілки, які об’єднуються в спільну гілку кілька разів на день, де серія автоматизованих тестів дає відгук про внесені зміни. Безперервна доставка (CD) – після безперервної інтеграції безперервна доставка готує програмне забезпечення до деплою; реліз на проді зазвичай виконується вручну. Безперервне розгортання – після CI та CD зміни автоматично розгортаються на проді; повністю автоматизований процес. Однак усі ці процеси повинні слідувати один за одним, а безперервна інтеграція є основою для двох інших.

Continuous testing Ми вже згадували, що під час CI/CD програмне забезпечення проходить низку автоматизованих тестів. Таким чином, процес CI/CD може включати такі типи тестів:

У наведеній нижче піраміді тестування показано різні типи тестів, які можна запустити. У деяких випадках вам може не знадобитися виконувати всі ці тести, особливо якщо ви тільки починаєте.

Юніт тести – для перевірки окремих частин програми. Ця ізольована частина бази коду називається блоком. Інтеграційні тести – оскільки юніт тести зосереджуються на окремому компоненті й, отже, самі по собі можуть бути недостатніми, інтеграційні тести гарантують правильну роботу кількох компонентів разом і перевіряють, як частини програми працюють разом як єдине ціле. Функціональні тести – ці тести перевіряють, чи функціонал працює належним чином. е2е тести – ці тести імітують роботу користувача, щоб переконатися, що реальні користувачі отримають роботу без помилок. Аксептенс тести – перевіряють поведінку програмного забезпечення під значним навантаженням, щоб забезпечити його стабільність і надійність

У наведеній нижче піраміді тестування показано різні типи тестів, які можна запускати.



Оскільки юніт тести є найлегшими для реалізації, вимагаючи менше ресурсів, вони, як правило, створюють гарну основу для швидкої збірки та набагато швидшого отримання відгуків від розробників. Тим часом тести інтерфейсу користувача, які гарантують, що програма працює правильно з точки зору користувача, набагато повільніші та складніші для виконання. Підсумовуючи, не кожен процес CI/CD повинен мати всі ці тести, але варто пам’ятати, що постійне тестування за допомогою автоматизації є ключовим компонентом безперервної інтеграції та безперервної доставки.

CI/CD pipeline
CI/CD пайплайн — це серія процесів: стягування коду з репо, збірка білда, запуск автоматизованих тестів, які супроводжують програмне забезпечення протягом життєвого циклу розробки, доставляючи вихідний код до проду.

Таким чином, пайплайн будує код, запускає тести, а потім розгортає нове програмне забезпечення на проді.

Включення і налаштування CI/CD пайплайну є важливим фактором для підтримки культури DevOps, оскільки це забезпечує швидкий і ефективний випуск програмного забезпечення з мінімальним ризиком. Таким чином, побудова конвеєра CI/CD реалізує ідеали DevOps на практиці, оскільки дозволяє розробникам часто вносити зміни, щоб отримати швидкий зворотний зв’язок, що веде до появи культури співпраці, підвищення продуктивності та прозорості між командами. Ці швидкі цикли зворотного зв’язку допомагають досягти головної мети створення ефективного CI/CD пайплайну, що зменшує ризик, зазвичай пов’язаний із новими релізами.
!https://www.abtasty.com/wp-content/uploads/ci-cd-pipeline.png

Етапи CI/CD пайплайну включають:

Source: CI/CD пайплайн запускається, коли новий код закомічений в репозиторій. Build: тут розробники вносять свої нові зміни в код і компілюють їх, щоб вони могли пройти через початкову фазу тестування Test: це коли новий код перевіряється за допомогою автоматизованих тестів (наприклад, запуск юніт тестів через постійну інтеграцію). Залежно від розміру та складності програмного забезпечення цей крок може тривати від секунд до годин. На цьому етапі буде надано зворотний зв’язок, необхідний розробникам для вирішення будь-яких проблем. Deploy: це коли код розгортається в середовищі тестування або стейджингу, щоб підготувати його до фінального релізу, тобто безперервної доставки. Зазвичай білд автоматично розгортається після проходження серії автоматизованих тестів. Deploy to production: код релізиться на прод для кінцевих користувачів вручну або автоматично

CI/CD tools
Jenkins: це один із найвідоміших інструментів із відкритим кодом для CI/CD. Як розширюваний сервер автоматизації його можна використовувати як сервер CI і перетворити на центр безперервної доставки.

CircleCI: інструмент, який пропонує гнучкі середовища та тисячі готових інтеграцій; Оркестровка CI/CD у хмарі або можливість використовувати автономні ранери для додаткової гнучкості та контролю.

GitLab CI/CD: цей інструмент дозволяє оптимізувати й автоматизувати процес релізу, пропонуючи безпечні та гнучкі варіанти розгортання. GitLab також діє як єдине джерело правди для CI/CD, тому ви можете створювати, тестувати, розгортати та контролювати свій код з однієї програми.

Travis CI: це платформа CI/CD з відкритим кодом, яка допомагає розробникам швидко та легко розробляти, тестувати та розгортати код. Цей інструмент швидко налаштовується та підтримує понад 30 мов, що забезпечує велику гнучкість.

GitHub Actions: це платформа CI/CD (Continuous Integration/Continuous Deployment), яка дозволяє автоматизувати ваші тестувальні та розгортальні процеси прямо у вашому репозиторії GitHub.

❗Це не весь список - є ще багато інших інструментів які є зараз.